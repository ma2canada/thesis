%\chapter{Ch3-AsymmetricLogistic}
\chapter{Invasion: Transition from One Species to Two}
%NTS:::EXTIRPATED means locally extinct

%Should I include the other symmetry breaks here? Or in the previous chapter? In previous chapter

%The previous chapter should end with a rough estimate of monocultures vs mixed states, using only an immigration rate and explicitly assuming that - NO, because if you assume that the system goes to the fixed point first then you never have monocultures.
%The previous chapter should end with a brief discussion of abundances and coalescents. Such a discussion will naturally motivate this chapter - perhaps the discussion should be at the start of this chapter. 

%\section{pre-intro}%NTS
This chapter, along with the next one, is based on a paper written by me and my supervisor Anton Zilman, which is currently under revision for The Proceedings of the Royal Society Journal \cite{Badali2019a}. 
%will be published in a Royal Society journal \cite{Badali2019a}. 
%Half of this research has been submitted, in conjunction with the previous chapter, to be published in Journal of the Royal Society: Interfaces. 

%Note also that I talk about foreign invading immigrants in this chapter. This is not meant to be related to human immigrants into a country (which I view favourably). 


\section{Introduction}
The previous chapter regarded an ecosystem with two competing species, and asked questions about the mean time until one of the species goes extinct and the other fixates in the system. 
In this chapter I aim to look at the reverse problem; starting with a stable system with one species, what is the probability and timescale that a second one will enter and establish itself, given some overlap between the niches of the extant and immigrating species. 
First I would like to motivate the problem and discuss where a new species entering a system might come from. 

Invasion, in one form or another, is a relevant factor in a variety of biological contexts. 
When a new allele arises in a population of genes it acts as an invader, and if it is successful it contributes to the genetic diversity of the population
This is the situation considered by Kimura and Crow as they analyzed the probability of a single mutant or immigrant allele to fixate \cite{Crow1956,Kimura1964,Kimura1968}. 
Invasion is also of relevance in biodiversity. 
The biodiversity of an island increases as immigrants from a neighbouring mainland enter (and decreases as species go locally extinct); the idea of these forces balancing was one of the historic contributions of MacArthur and Wilson \cite{MacArthur1963,MacArthur1967a}. 
%More generally, t
The biodiversity of an ecosystem is also maintained by invaders generated by speciation, as per Hubbell's neutral theory, which predicts the abundance distribution of species \cite{Hubbell2001}. 
%
%"strategic lit review"
%Kimura is famous for introducing the Fokker-Planck equation to a genetic context, and more generally for promoting mathematical modeling in biology. 
%The work of Kimura and Crow offers a suggestion, that new genes arise from gene mutations and migration. 
%One of the topics he treated in this way, in this case with Crow, is that of a population undergoing random drift and linear pressure \cite{Crow1956,Kimura1964}. 
%``Under the term linear pressure,'' he writes, ``we include the pressures of gene mutations and of migration.'' 
%Many of the historical giants I included in the introductory chapter have considered the problem of the arrival of a new strain or species in one way or another. 
%Kimura and Crow analyzed the evolution of the probability of a single allele in a population, one that arose via genetic mutation or immigration, to find its fixation probability \cite{Crow1956,Kimura1964,Kimura1968}. 
%MacArthur and Wilson considered islands receiving an influx of immigrants from a neighbouring mainland to find the total number of distinct species on an island \cite{MacArthur1963,MacArthur1967}. %NTS:::see Kessler and Shnerb 2015 - I summarized that Wilson-MacArthur model is a bunch of independent logistics!!!
%Hubbell builds off of MacArthur and Wilson to predict the abundance distribution of species in a system balanced between influx of new species and extinction of extant ones \cite{Hubbell2001}. 
%New species can arise from speciation or from a larger reservoir. 
Bearing these historical precedents in mind, I do not distinguish from where a new strain or species might enter in my modelling below; mutation, speciation, and immigration are all viable. 
What is important to my research is that a distinct second species is attempting to invade an already occupied system. 
%"gap"
%However, mathematically the approach has typically been with the Fokker-Planck equation, which I argued earlier is not the fundamental way of representing systems with demographic noise. %NTS:::do this.
%In terms of the biology, the cases that have been regarded in the past have been either when the invader is under positive or negative selection \cite{Kimura1955} or else when they are truly neutral \cite{Kimura1956,Hubbell2001}. %NTS:::previously explain truly neutral vs unbiased. %get a better reference than Hubbell - see niche vs neutral presentation
Whether the invader is under selection \cite{Kimura1955} or the system is neutral \cite{Crow1956,Hubbell2001}, the literature regards cases where the system is constrained to the Moran line, to constant population size. %Kimura1956??
%NTS:::a million more references, including those from the paper rejection, and a comment about what I mean by invasion
%NTS:::what does selection look like in the LV model?
What has \emph{not} been done is to look at an invasion attempt into an established niche when the invader has partial niche overlap with the established species. 

By using the two species Lotka-Volterra model from the previous chapter I can study invasion in the neutral case where the system is allowed to fluctuate off the Moran line, or even when the two species should happily coexist in the deterministic limit, \emph{i.e}. with partial niche overlap and a single stable coexistence fixed point. 
%"thesis" "in this chapter I will..."
%Why? Why is this interesting? Why is it different from the previous cases? 
%This is what I aim to do in this chapter, using a matrix cutoff to solve the backward master equation. 
I do this by continuing to use the truncated transition matrix inverse to solve the backward master equation for arbitrary accuracy. 
%Furthermore, the literature typically argues that invasion attempts are rare and so they may be treated independently, but this need not always be the case, depending on the immigration rate (see, for example, \cite{Goyal2015}). 
Furthermore, the literature typically argues that invasion attempts are sufficiently rare that when an invader arrives it will either successfully invade or die off before another member of the same strain invades. 
Indeed, this is one of my assumptions when using the Lotka-Volterra model below. 
But this need not be the case, depending on the immigration rate (see, for example, \cite{Goyal2015}); in chapter 5 I analyze the Moran model with an immigration term, which allows for repeated concurrent invaders of the same species. 
In either case I do not worry about effects like clonal interference or multiple mutations (as they do in \cite{Desai2007}), since the mutations are either rare or equivalent in my models. 
Anyway, immigration is more appropriate than mutation for the introduction of invaders, since having the same mutation recurring independently is unlikely, unless there is a common mutation pathway or if we categorize all equivalent mutants into one category of invader. 
%-also mostly only looked at an individual invader; what are the effects of multiple invaders

In this chapter I shall investigate how the success probability and mean times scale with niche overlap, carrying capacity, and immigration rate, and in so doing I shall uncover critical combinations of these parameters as they affect the scaling of the mean times and the shape of the steady state population probability distribution. 
Having increased niche overlap leads to lesser chance of invasion and greater times before the attempt resolves. 
In the Moran model with immigration, the steady state distribution changes from unimodal to bimodal around when the inverse immigration rate of a strain is equal to the expected population of that strain in the system. 

%"roadmap"
There are a few steps needed to get to these conclusions. 
%I will continue using the generalized Lotka-Volterra model from the previous chapter. 
Within the generalized Lotka-Volterra model there is some ambiguity in the definition of a successful invasion, which I will discuss in the next section before providing a definition. 
%I must define what is meant by invasion before I find the probability of a successful invasion attempt. 
%Similar to the invasion success probability, I shall find the mean times conditioned on the success or failure of an attempt. 
And since there is a chance of success or failure, I shall also find the mean times conditioned on the outcome of that attempt. 
In the previous chapter because of the initial conditions each species was equally likely to go extinct first. 
In this chapter's case, it is possible (and indeed true) that an invasion attempt that is ultimately successful will take a long time (though still short when compared to the fixation times of the previous chapter), whereas one that is transient and ultimately unsuccessful will fail quickly. 
These are the conditional mean times, and their scaling with carrying capacity will be analyzed, since exponential scaling implies that the event effectively does not happen. 
%In order to extend these results to the circumstance of repeated concurrent invaders in the Moran limit I analyze the Moran model with an immigration term. 
%I find the steady state probability distribution analytically to allow for an investigation of the critical parameter combinations that change the concavity of the curve. 
%Along with the probability distribution I find the mean time to fixation, both unconditioned and conditioned on whether the species first fixates or goes extinct in the system. 
%%"short significance"
%%These results have a couple of uses. 
%The application is in neutral theories like that of Hubbell \cite{Hubbell2001}; I find the qualitatively different regimes of the probability distribution, which can be extended to abundance distributions. 
Neutral theories of the maintenance of biodiversity argue that no species truly establishes itself, and biodiversity is maintained by transient species in the system. 
Calculation of the steady state number of species requires the time that these transient species exist in the system. 
%It is worth noting that inevitably all the species in the theoretical work below are transient, on one timescale or another. 
My results hold both for a species in an ecosystem (hence its relevance to conservation biology, where biodiversity is a marker of ecosystem robustness \cite{Peterson1997,McKane2003,Green2005,Bickford2007}) and a gene in a population (hence its use in calculating heterozygosity, which confers resilience to environmental changes \cite{Kimura1971,Kawecki2004,Korolev2011,Pennings2014}). 
There are also more practical applications, for example the susceptibility of a microbiome ecosystem like the gut or lungs to invasion, say from salmonella or pneumococcus \cite{Kinross2011,Koenig2011,Roeselers2011,Fisher2014a,Theriot2014,Corander2017,Amor2019}. 

\iffalse
Transient coexistence during the fixation/extinction process of immigrants/mutants has also been proposed as a mechanism for observed biodiversity in a number of contexts \cite{Kimura1964,Dias1996,Hubbell2001,Chesson2000,Leibold2006,Kessler2015,Vega2017}. 
The extent of this biodiversity is constrained by the interplay between the residence times of these invaders and the rate at which they appear in a settled population. 
In the previous sections we calculated the fixation times in the two species system starting from the deterministically stable fixed point. 
In this section we investigate the complementary problem of robustness of a stable population of one species with respect to an invasion of another species, arising either through mutation or immigration, and investigate the effect of niche overlap and system size on the probability and mean times of successful and failed invasions. 
\fi


\section{Defining invasion in the 2D Lotka-Volterra model}

As before, I employ the symmetric generalized LV model with niche overlap $a$ and carrying capacity $K$. 
I study the case where the system starts with $K-1$ individuals of the established species and $1$ invader. 
This initial condition corresponds to a birth of a mutant. 
%To accurately reflect a new immigrant an initial condition of $K$ established organisms and the $1$ invader would be more appropriate; however, the following results would be largely unchanged, so I elect only one initial condition. 
An initial condition of $K$ established organisms and the $1$ invader gives similar results. 
%In any case, the established species before the arrival of the invader would naturally fluctuate about the carrying capacity, so an initial population of $K-1$ individuals is reasonable. 
The species' dynamics are described by the birth and death rates defined by equations (\ref{deathrate}) from the previous chapter, which I reproduce here:
\begin{align*}
	b_i/x_i &= r_i \\
	d_i/x_i &= r_i\frac{x_i+a_{ij}x_j}{K_i}. 
\end{align*}

An invasion is unsuccessful if the invading species dies out before establishing itself in the system. 
There are many ways to define what it means for a species to be established, and I will outline one such definition below. 
Deterministically the system would grow to asymptotically approach the coexistence fixed point; deterministically, all invasion attempts are successful, and stochasticity is required for nontrivial invasion probabilities. 
In a stochastic system, the populations could very easily fluctuate \emph{near} the fixed point without touching that exact point. 
This would overestimate the time to establishment, or even misrepresent a successful invasion as unsuccessful if the system gets near the fixed point without reaching it but then goes extinct. 
%(Indeed, there is a non-zero probability that the established species dies out before the system reaches the coexistence fixed point, which clearly should count as a successful invasion but would ultimately count as unsuccessful once the invader species also goes extinct.) 
Indeed, there is even a chance the established species dies out before the system reaches the coexistence fixed point, which would be counted as an unsuccessful invasion. 
For these reasons a successful invasion should not be defined as the system arriving at the coexistence point. 
%Nor should invasion mean getting within a region of this fixed point, by the same arguments. 
The same arguments hold for a defined region near the fixed point (for instance, within three birth or death events, or within a circle of radius $\varepsilon$): the region might by chance be avoided for a time even after the invader is more populous than the original species, which could even go extinct before the invader. 
Inspired by the observation that in the symmetric case, the coexistence fixed point has the same population of each species, I consider the invasion successful if the invader grows to be half of the total population without dying out first. 
So long as the invader population matches that of the established species, regardless what random fluctuations may have made that population to be, the invasion is a success. %Anton says, "No need in rhetorics." What does that mean? Unclear. Does he not like my sentence structure? He wasn't explicit, and I do, so it stays. 
These considerations of the definition of invasion are similar to those of Parsons \cite{Parsons2018}, who regards a single species problem, but nowhere else in the literature have I seen invasion treated in this way; typically (especially in the genetics literature) when an author says invasion they mean fixation. 
Thus all the results of this chapter are novel (although the techniques employed are not). 

%I denote the probability of a invader success as $\mathcal{P}$. 
Along with the probability of a successful invasion attempt (which I denote $\mathcal{P}$), I am interested in the timescales involved. 
As such, I will consider conditional mean times, conditioned on either success or failure of the invasion attempt. 
The mean time to a successful invasion is written as $\tau_s$, and the mean time of a failed invasion attempt as $\tau_f$. 
More generally, invasion probability and the successful and failed times starting from an arbitrary state $s^0$ are denoted as $\mathcal{P}^{s^0}$, $\tau_s^{s^0}$ and $\tau_f^{s^0}$, respectively. 

Similar to equation (\ref{explicit-tau}) in a previous chapter, the invasion probability can be obtained from \cite{Nisbet1982,Iyer-Biswas2015}
\begin{equation}
\mathcal{P}^{s^0} = -\sum_s \hat{M}^{-1}_{s,s^0}\alpha_{s} %eq'n 36 in Iyer-Biswas and Zilman
 \label{conditionalP}
\end{equation}
and the times from
\begin{equation}
\Phi^{s^0} = -\sum_s \hat{M}^{-1}_{s,s^0}\mathcal{P}^{s}, %eq'n 38 in Iyer-Biswas and Zilman
 \label{conditionalPhi}
\end{equation}
where $\alpha_s$ is the transition rate from a state $s$ directly to extinction or invasion of the invader and $\Phi^{s^0}=\tau^{s^0}\mathcal{P}^{s^0}$ is a product of the invasion or extinction time and probability. 
Similar equations describe $\tau_f$ \cite{Nisbet1982,Iyer-Biswas2015}.
%$E_s = \mathcal{P}_{(1,K-1)}$
As in the previous chapter, I truncate the transition matrix and invert it in order to solve these equations. 


\section{Invasion probability and times into the Lotka-Volterra model}
\begin{figure}[h]
	\centering
	\begin{minipage}{0.49\linewidth}
		\centering
		\includegraphics[width=1.0\linewidth]{fiftyfifty-probvK.pdf}
	\end{minipage}
	\begin{minipage}{0.49\linewidth}
		\centering
		\includegraphics[width=1.0\linewidth]{fiftyfifty-probva.pdf}
	\end{minipage}
	%  \includegraphics[width=0.9\linewidth]{invasion-prob-succ}
	\caption{\emph{Probability of a successful invasion.}
		\emph{Left:} Numerical results, from $a=0$ at the top to $a=1$ at the bottom. The purple solid line is the expected analytical solution in the independent limit. The green solid line is the prediction of the Moran model in the complete niche overlap case. Data come from equation \ref{conditionalP} and are connected with dotted lines to guide the eye. 
		\emph{Right:} The red data show the results for carrying capacity $K=4$, and suggest the solid black line $\frac{b_{mut}}{b_{mut}+d_{mut}}$ is an appropriate small carrying capacity limit. Successive lines are at larger system size, and approach the solid magenta line of $1-d_{mut}/b_{mut}\approx 1-a$.
	} \label{Esucc}
\end{figure}

Figure \ref{Esucc} shows the calculated invasion probabilities as a function of the carrying capacity $K$ and of the niche overlap $a$ between the invader and the established species. 
In the complete niche overlap limit, $a=1$, the dependence of the invasion probability on the carrying capacity $K$ closely follows the results of the classical Moran model, $\mathcal{P}^{s^0}=2/K$ \cite{Moran1962}, shown in the blue dotted line in the left panel, and tends to zero as $K$ increases. 
In the other limit, $a=0$, the problem is well approximated by the one-species stochastic logistic model starting with one individual and evolving to either $0$ or $K$ individuals; the exact result in this limit is shown in black dotted line, referred to as the independent limit \cite{Nisbet1982}. 
In the independent limit, $a=0$, the invasion probability asymptotically approaches $1$ for large $K$, reflecting the fact that the system is deterministically drawn towards the deterministic stable fixed point with equal numbers of both species. 
As $K$ gets large, fluctuations are minimal and the system becomes more deterministic. 
Interestingly, the invasion probability is a non-monotonic function of $K$ and exhibits a minimum at an intermediate/low carrying capacity, which might be relevant for some biological systems, such as in early cancer development \cite{Ashcroft2015} or plasmid exchange in bacteria \cite{Gooding-townsend2015}.

For the intermediate values of the niche overlap, $0<a<1$, the invasion probability is observed to be a monotonically decreasing function of $a$, as shown in the right panel of figure \ref{Esucc}. 
For large $K$, the outcome of the invasion is typically determined after only a few steps: since the system is drawn deterministically to the mixed fixed point, the invasion is almost certain once the invader has reproduced several times. 
At early times, the invader birth and death rates (\ref{deathrate}) are roughly constant, and the invasion failure can be approximated by the extinction probability of a birth-death process with constant death $d_{mut}$ and birth $b_{mut}$ rates. 
The invasion probability is then $\mathcal{P}=1- d_{mut}/b_{mut}\approx 1-a$. 
This heuristic estimate is in excellent agreement with the numerical predictions, shown in the right panel of figure \ref{Esucc} as a purple dashed and the blue lines respectively.
Similarly, for small $K$ either invasion or extinction typically occurs after only a small number of steps. 
The invasion probability in this limit is dominated by the probability that the lone mutant reproduces before it dies, namely $\frac{b_{mut}}{b_{mut}+d_{mut}} = \frac{K}{K(1+a)+1-a}$, as shown in black dotted line in the right panel of figure \ref{Esucc}.

\iffalse
\begin{figure}[ht!]
	\centering
	\begin{minipage}{0.49\linewidth}
		\centering
		\includegraphics[width=1.0\linewidth]{fiftyfifty-invtimevK.pdf}
	\end{minipage}
	\begin{minipage}{0.49\linewidth}
		\centering
		\includegraphics[width=1.0\linewidth]{fiftyfifty-invtimeva.pdf}
	\end{minipage}
	%  \includegraphics[width=0.9\linewidth]{invasion-time-succ}
	\caption{\emph{Mean time of a successful invasion.}
		\emph{Left:} Solid lines are the numerical results, from $a=0$ at the bottom to $a=1$ at top. The blue dashed line shows for comparison the predictions of the Moran model in the complete niche overlap limit, $a=1$; see text. The black line correspond to the solution of an independent stochastic logistic species, $a=0$.
		\emph{Right:} The solid red line shows the results for small carrying capacity ($K=4$), and successive lines are at larger system size, up to $K=256$. The dashed blue line is $1/(b_{mut}+d_{mut})$ and matches with small $K$.
	} \label{Tsucc}
\end{figure}
\fi
The upper panels of figure \ref{TsuccTfail} show the dependence of the mean time to successful invasion, $\tau_s$, on $K$ and $a$. 
Increasing $K$ can have potentially contradictory effects on the invasion time, as it increases the number of births before a successful invasion on the one hand, while increasing the steepness of the potential landscape and therefore the bias towards invasion on the other. %EDIT:::Maddy was confused about this point, thinking the larger K making it steeper means it is more deterministic-like and fluctuations are less relevant - this is true, but does not explain why increasing K might reduce the time
Nevertheless, the invasion time is a monotonically increasing function of $K$ for all values of $a$. 
In the complete niche overlap limit $a=1$ the invasion time scales linearly with the carrying capacity $K$, as expected from the predictions of the Moran model, $\tau_{s} = \Delta t K^2(K-1)\ln\left(\frac{K}{K-1}\right)$ with $\Delta t\simeq 1/K$, as explained above. %NTS:::more info?
%NTS:::$\Delta t \neq K$ but $3/K$, and only at equal pops, which is strictly not true here
%in response to Anton's question, the asymptotic scaling of this is $\tau \sim K$ for large $K$ and $\Delta t \sim K$
The quantitative discrepancy arises from the breakdown of the $\Delta t\simeq 1/K$ approximation off of the Moran line. %NTS:::say more? - yes!
For all values $0\leq a<1$ the invasion time scales sub-linearly with the carrying capacity, indicating that successful invasions occur relatively quickly, even when close to complete niche overlap, where the invading mutant strongly competes against the stable species. 
In the $a=0$ limit of non-interacting species, the invading mutant follows the dynamics of a single logistic system with the carrying capacity $K$, resulting in the invasion time that grows approximately logarithmically with the system size, as shown in the upper left panel of figure \ref{TsuccTfail} as a purple line. 
This result is well-known in the literature, often stated without reference \cite{Lande1993,Parsons2018}. 
It is easy to see: by writing $\tau_s = \int dt = \int_{x_o}^{x_f} dx \frac{1}{\dot{x}}$ for initial state $x_0=1$ and final state $x_f=(1-\epsilon)K$ with small $\epsilon$ and large $K$ we get
\begin{align*}
\tau_s &= \frac{1}{r}\int_{x_o}^{x_f} dx \frac{K}{x(K-x)} = \frac{1}{r}\int_{x_o}^{x_f} dx \left(\frac{1}{x}-\frac{1}{K-x} \right) = \frac{1}{r}\ln\left[\frac{x}{K-x} \right]\mid_{x_o}^{x_f} = \frac{1}{r}\ln\left[\frac{x_f(K-x_o)}{x_o(K-x_f)} \right] \\
	   &\approx \frac{1}{r}\ln\left[\frac{(1-\epsilon)K}{\epsilon} \right] \approx \frac{1}{r}\left(\ln\left[K\right]-\ln\left[\epsilon\right]\right)
\end{align*}
and so expect the invasion time to grow logarithmically with carrying capacity. 

%\iffalse
\begin{figure*}[h]
	\centering
	\begin{minipage}[b]{0.475\textwidth}
		\centering
		\includegraphics[width=\textwidth]{fiftyfifty-invtimevK.pdf}
		%\caption[Network2]%
		%{{\small Network 1}}    
		%\label{fig:mean and std of net14}
	\end{minipage}
	\hfill
	\begin{minipage}[b]{0.475\textwidth}  
		\centering 
		\includegraphics[width=\textwidth]{fiftyfifty-invtimeva.pdf}
		%\caption[]%
		%{{\small Network 2}}    
		%\label{fig:mean and std of net24}
	\end{minipage}
	\vskip\baselineskip
	\begin{minipage}[b]{0.475\textwidth}   
		\centering 
		\includegraphics[width=\textwidth]{fiftyfifty-exttimevK.pdf}
		%\caption[]%
		%{{\small Network 3}}    
		%\label{fig:mean and std of net34}
	\end{minipage}
	\quad
	\begin{minipage}[b]{0.475\textwidth}   
		\centering
		\includegraphics[width=\textwidth]{fiftyfifty-exttimeva.pdf}
		%\caption[]%
		%{{\small Network 4}}    
		%\label{fig:mean and std of net44}
	\end{minipage}
	\caption{\emph{Mean time of a successful or failed invasion attempt.}
		\emph{Upper Left:} Dotted lines connect the numerical results of invasion times conditioned on success, from $a=0$ at the bottom being mostly fastest to $a=1$ being slowest. The solid green line shows for comparison the predictions of the Moran model in the complete niche overlap limit, $a=1$; see text. The solid purple line correspond to the solution of an independent stochastic logistic species, $a=0$, and overestimates the time at small $K$ but fares better as $K$ increases.
		\emph{Upper Right:} The red line shows the results of successful invasion time for carrying capacity $K=4$, and successive lines are at larger system size, up to $K=256$. The cyan line is $1/(b_{mut}+d_{mut})$ and matches with small $K$. 
		\emph{Lower Panels:} Same as upper panels, but for the mean time conditioned on a failed invasion attempt. 
	} \label{TsuccTfail}
\end{figure*}
%\fi
\iffalse
\begin{figure}[h]
	\centering
	\begin{minipage}{0.49\linewidth}
		\centering
		\includegraphics[width=1.0\linewidth]{fiftyfifty-exttimevK.pdf}
	\end{minipage}
	\begin{minipage}{0.49\linewidth}
		\centering
		\includegraphics[width=1.0\linewidth]{fiftyfifty-exttimeva.pdf}
	\end{minipage}
	%  \includegraphics[width=0.9\linewidth]{invasion-time-fail}
	\caption{\emph{Mean time of a failed invasion.}
		\emph{Left:} Solid lines are the numerical results, from $a=0$ mostly being fastest to $a=1$ being slowest, for large $K$. The blue dashed line is the analytical approximation of the Moran model result, and black is a 1D stochastic logistic system, which overestimates the time at small $K$ but then converges to the same limiting value.
		\emph{Right:} The solid red line shows the results for small carrying capacity ($K=4$), and successive lines are at larger system size, up to $K=256$. The dashed blue line is $1/(b_{mut}+d_{mut})$ and matches with small $K$.
	} \label{Tfail}
\end{figure}
\fi

Unlike the mean times conditioned on success, the failed invasion time, shown in the lower left panel of figure \ref{TsuccTfail}, is non-monotonic in $K$. 
The analytical approximations of the Moran model and the of two independent 1D stochastic logistic systems recover the qualitative dependence of the failed invasion time on $K$ at high and low niche overlap, respectively. 
All failed invasion times are fast, with the greatest scaling being that of the Moran limit. 
For $a<1$ these failed invasion attempts appear to approach a constant timescale at large $K$.

The dependence of the time of an attempted invasion (both for successful and failed ones) on the niche overlap $a$ is different for small and large $K$, as shown in the right panels of figure \ref{TsuccTfail}. 
For small $K$ both $\tau_s$ and $\tau_f$ are monotonically decreasing functions of $a$, with the Moran limit having the shortest conditional times. 
In this regime, the extinction or fixation already occurs after just a few steps, and its timescale is determined by the slowest steps, namely the mutant birth and death. 
Thus $\tau \approx \frac{1}{b_{mut}+d_{mut}}=\frac{K}{K+1+a(K-1)}$, as shown in the figure as the solid cyan line. 
By contrast, at large $K$, the invasion time is a non-monotonic function of the niche overlap, increasing at small $a$ and decreasing at large $a$. 
This behavior stems from the conflicting effect of the increase in niche overlap: on the one hand, increasing $a$ brings the fixed point closer to the initial condition of one invader, suggesting a shorter timescale; on the other hand, it also makes the two species more similar, increasing the competition that hinders the invasion.


\section{Discussion} \label{DiscussionOfOneAttemptedInvasion}
Unlike the fixation times of the previous chapter, invasions into the system do not show exponential scaling in any limit. 
Indeed, all scaling with $K$ is sublinear except in the complete niche overlap limit for successful invasion times. 
The timescale of a successful invasion varies between linear and logarithmic scaling in the system size. 
The mean time of an unsuccessful invasion is even faster than logarithmic, and for large $K$ it becomes independent of $K$. 
Curiously, these failed invasion attempts are non-monotonic, at intermediate carrying capacity and niche overlap values. %NTS:::heat map?
As for the probabilities, the likelihood of a failed invasion attempt grows linearly with niche overlap, for sufficiently large $K$. 
For complete niche overlap the invasion probability goes asymptotically to zero, but it is low even for partially mismatched niches. 

High niche overlap makes invasion difficult due to strong competition between the species. 
In this regime, the times of the failed invasions become important because they set the timescales for transient species diversity. 
If the influx of invaders is slower than the mean time of their failed invasion attempts, most of the time the system will contain only one settled species, with rare ``blips'' corresponding to the appearance and quick extinction of the invader. 
On the other hand, if individual invaders arrive faster than the typical times of extinction of the previous invasion attempt, the new system will exhibit transient coexistence between the settled species and multiple invader strains, determined by the balance of the mean failure time and the rate of invasion \cite{Dias1996,Chesson2000,Hubbell2001,Desai2007,Carroll2015}. 
Recent research from the Gore lab shows that these transient species can have lasting effects on the distribution of extant species \cite{Amor2019}. %, but I do not study the structure of the surviving species here. 
Full discussion of diversity in this regime is beyond of the scope of the present work. % but see \cite{Dias1996,Hubbell2001,Chesson2000}. 
The weaker dependence of the invasion times on the population size and the niche overlap, as compared to the escape times of a stably coexisting system to fixation, imply that the transient coexistence is expected to be much less sensitive to the niche overlap and the population size than the steady state coexistence. 
Curiously, both niche overlap and the population size can have contradictory effects on the invasion times (as discussed in the previous section) resulting in a non-monotonic dependence of the times of both successful and failed invasions on these parameters. 

For species with low niche overlap, the probability of invasion is likely, and for large $K$ decreases monotonically as $1-a$ with the increase in niche overlap, independent of the population size $K$. 
The mean time of successful invasion is relatively fast in all regimes, and scales linearly or sublinearly with the system size $K$ and is typically increasing with the niche overlap $a$.

%NTS:::maybe have a small summary paragraph. Add a comment on if there are multiple species (and do tthis in chapter 2 as well)

%For this reason we have calculated the mean failure time, the mean time of invasion, and the probability of such a success. 
The fixation times of two coexisting species, discussed in the previous chapter, determine the timescales over which the stability of the mixed populations can be destroyed by stochastic fluctuations. 
Similarly, the times of successful and failed invasions set the timescales of the expected transient coexistence in the case of an influx of invaders, arising from mutation, speciation, or immigration \cite{Hubbell2001,Desai2007,Carroll2015}. 
Our results provide a timescale to which the rate of immigration or mutation can be compared. 
\iffalse
Once the invader arrives the dynamics and its ultimate fate depend on how much its niche overlaps with the species currently present in the system. 
It will be most excluded by those with high population and those with large niche overlap. 
In the research above I have considered the case of only one extant species upon the arrival of an invader. 
For species with low niche overlap, the probability of invasion is likely, and for large $K$ decreases monotonically as $1-a$ with the increase in niche overlap, independent of the population size $K$. %first figure
The invader is least likely to be successful in the Moran limit when niche overlap is complete. 
For invaders that are mutants of the extant wild type species, this $a=1$ is the niche overlap they are most likely to experience, and so the more similar a mutant is to the wildtype, the less likely it is to reach half the population size, which is how I have defined a successful invasion. 

Whether or not a mutant invasion is successful, the timescale is longest when niche overlap is high. %second and third figures
The times of successful and failed invasions into a stable population set the timescales of the expected transient coexistence in the case of an influx of invaders, arising from mutation, speciation, or immigration \cite{Hubbell2001,Desai2007,Carroll2015}. 
The mean time of successful invasion is relatively fast in all regimes, and scales linearly or sublinearly with the system size $K$. 
By contrast, high niche overlap makes invasion difficult due to strong competition between the species. 
In the regime of high niche overlap, the times of the failed invasions become particularly salient because they set the timescales for transient species diversity. %EDIT:::redundant/in conflict with three lines earlier
We must compare the rate of invasion attempts to the time to success or failure of an invasion attempt. 
If the influx of invaders is slower than the mean time of their failed invasion attempts, most of the time the system will contain only one settled species, with rare ``blips'' corresponding to the appearance and quick extinction of the invader \cite{Dias1996,Hubbell2001,Chesson2000}. 
%EDIT:::Gore \cite{Amor2019} shows that transients can affect the lasting distribution
Recent research from the Gore lab shows that these transient species can have lasting effects on the distribution of extant species \cite{Amor2019}, but I do not study the structure of the surviving species here. 
On the other hand, if individual invaders arrive faster than the typical times of extinction of the previous invasion attempt, they will buoy the population in the system, maintaining its presence. %buoy/stabilize
\fi
If the influx of invaders is slower than the mean time of their failed invasion attempts, each attempt is independent and has the invasion probability we have calculated. 
%Most of the time the system will contain only one settled species, with rare ``blips'' corresponding to the appearance and quick extinction of the invader \cite{Dias1996,Hubbell2001,Chesson2000}. 
In the extreme case of this, that is, if the time between invaders is even longer than the fixation times calculated in the previous chapter, then serial monocultures are expected.
If the rate in is greater than the mean failure time, the system will diversify. 
The balance between mutation or immigration coming into the system and these invaders failing to establish themselves determines how diverse a system will be. %NTS:::extend this discussion, hearken to the intro
With different strains of invaders arising faster than the time it takes to suppress the previous invasion attempt, the new strains interact with one another in ways beyond the scope of this thesis, leading to greater biodiversity. 
%We have also found that at large $K$ the likelihood of an invasion failing grows linearly with niche overlap, such that a mutant or immigrant is more likely to invade a system if its niche is more dissimilar with that of the established species.
%!!!%should be able to at least estimate steady state biodiversity as a function of mutation/immigration/speciation rate and niche overlap and carrying capacity using the parametrized plots !!! - it is just the ratio of lifetime of a species over (time between invasions divided by probability of a successful invasion); $(E^s\tau^s+E^f\tau^f)/\tau_{inv}$ - Iâ€™m not convinced that this is right either!!!
% - For large species: steady state is rate at which they successfully enter = rate at which they leave: E_s/\tau_{mut} = N_{big}(1/\tau_{ext} / 2?) where \tau_{ext} is the unconditioned extinction time - but then do I divide by the number of species since they're each equally likely to go extinct? Do I use \tau_{ext} with an effective carrying capacity based on the number of species?? I'm still not sure
% - For small species: steady state is rate at which they enter (as small) = rate at which they leave: E_f/\tau_{mut} = N_{small}/\tau_f
